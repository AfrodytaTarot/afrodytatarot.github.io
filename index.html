<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Afrody.ta Tarot - Lecturas precisas y guiadas</title>
    <link rel="stylesheet" href="https://use.typekit.net/csj0vlf.css">
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        :root {
            --primary-color: #ff8ec7;
            --secondary-color: #e8b9d0;
            --dark-bg: #0a0a0a;
            --medium-bg: #2d0f1f;
            --light-bg: rgba(90, 42, 63, 0.3);
            --border-color: #5a2a3f;
        }
        
        body {
            background-color: var(--dark-bg);
            color: #f8e9f0;
            line-height: 1.6;
            font-family: "futura-pt", sans-serif;
            font-weight: 300;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header y navegaci√≥n */
        header {
            background: linear-gradient(to bottom, var(--medium-bg) 0%, var(--dark-bg) 100%);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--border-color);
        }
        
        .header-content {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .logo {
            font-family: "carilliantine", serif;
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            font-weight: 400;
            text-align: center;
            color: var(--primary-color);
            letter-spacing: 2px;
            margin-bottom: 0.5rem;
            text-shadow: 0 0 10px rgba(255, 142, 199, 0.4);
        }
        
        .tagline {
            font-family: "new-astro", sans-serif;
            text-align: center;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            color: var(--secondary-color);
            margin-bottom: 1rem;
            letter-spacing: 1px;
            line-height: 1.3;
        }
        
        .tabs {
            display: flex;
            justify-content: center;
            list-style: none;
            flex-wrap: wrap;
            gap: 5px;
            width: 100%;
        }
        
        .tab-button {
            background: transparent;
            color: var(--secondary-color);
            border: 1px solid var(--border-color);
            padding: 0.5rem 0.8rem;
            font-family: "new-astro", sans-serif;
            font-size: 0.85rem;
            cursor: pointer;
            border-radius: 20px;
            transition: all 0.3s;
            letter-spacing: 0.5px;
            flex: 1;
            min-width: 0;
            text-align: center;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .tab-button:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .tab-button.active {
            background: var(--border-color);
            border-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        /* Contenido de las pesta√±as */
        .tab-content {
            display: none;
            padding: 2rem 0;
            animation: fadeIn 0.8s;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* Hero Section */
        .hero {
            background: radial-gradient(ellipse at center, var(--medium-bg) 0%, var(--dark-bg) 70%);
            padding: 3rem 0;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100" opacity="0.03"><defs><pattern id="stars" patternUnits="userSpaceOnUse" width="100" height="100"><circle cx="20" cy="30" r="0.5" fill="white"/><circle cx="50" cy="10" r="0.3" fill="white"/><circle cx="80" cy="40" r="0.7" fill="white"/><circle cx="10" cy="70" r="0.4" fill="white"/><circle cx="40" cy="90" r="0.5" fill="white"/><circle cx="70" cy="60" r="0.3" fill="white"/><circle cx="90" cy="80" r="0.6" fill="white"/></pattern></defs><rect width="100" height="100" fill="url(%23stars)"/></svg>');
            z-index: 0;
        }
        
        .hero-content {
            position: relative;
            z-index: 1;
        }
        
        .hero h1 {
            font-family: "carilliantine", serif;
            font-size: clamp(1.8rem, 5vw, 3rem);
            color: var(--primary-color);
            margin-bottom: 1rem;
            letter-spacing: 1.5px;
            text-shadow: 0 0 15px rgba(255, 142, 199, 0.5);
            line-height: 1.2;
        }
        
        .hero p {
            font-family: "new-astro", sans-serif;
            font-size: clamp(0.9rem, 2.5vw, 1.2rem);
            max-width: 700px;
            margin: 0 auto 1.5rem;
            color: var(--secondary-color);
            line-height: 1.6;
        }
        
        .cta-section {
            margin-top: 2rem;
            padding: 1.5rem;
            background: var(--light-bg);
            border-radius: 10px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            border: 1px solid var(--border-color);
        }
        
        .cta-section p {
            font-family: "new-astro", sans-serif;
            font-size: clamp(0.85rem, 2vw, 1rem);
            margin-bottom: 1rem;
        }
        
        .btn {
            display: inline-block;
            background: linear-gradient(to right, var(--border-color), #3a1a2f);
            color: var(--primary-color);
            padding: 0.7rem 1.5rem;
            border: 1px solid var(--primary-color);
            border-radius: 25px;
            text-decoration: none;
            font-family: "new-astro", sans-serif;
            font-size: clamp(0.85rem, 2vw, 1rem);
            transition: all 0.3s;
            cursor: pointer;
            letter-spacing: 0.5px;
        }
        
        .btn:hover {
            background: var(--primary-color);
            color: var(--medium-bg);
            box-shadow: 0 0 15px rgba(255, 142, 199, 0.6);
        }
        
        /* Secciones */
        .section-title {
            text-align: center;
            margin-bottom: 2rem;
            font-family: "carilliantine", serif;
            font-size: clamp(1.8rem, 5vw, 2.5rem);
            color: var(--primary-color);
            letter-spacing: 1.5px;
            line-height: 1.2;
        }
        
        .section-subtitle {
            text-align: center;
            margin-bottom: 2rem;
            font-family: "new-astro", sans-serif;
            font-size: clamp(0.9rem, 2.5vw, 1.1rem);
            color: var(--secondary-color);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.4;
        }
        
        .about-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }
        
        .about-card {
            background: var(--light-bg);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            transition: transform 0.3s;
        }
        
        .about-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
        }
        
        .about-card h3 {
            font-family: "carilliantine", serif;
            font-size: clamp(1.3rem, 3vw, 1.6rem);
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        
        .about-card p {
            font-family: "futura-pt", sans-serif;
            color: var(--secondary-color);
            margin-bottom: 1rem;
            font-size: 0.95rem;
            line-height: 1.5;
        }
        
        .readings-list {
            list-style: none;
        }
        
        .readings-list li {
            margin-bottom: 0.7rem;
            position: relative;
            padding-left: 1.2rem;
            font-family: "futura-pt", sans-serif;
            color: var(--secondary-color);
            font-size: 0.95rem;
            line-height: 1.4;
        }
        
        .readings-list li:before {
            content: "‚ú¶";
            position: absolute;
            left: 0;
            color: var(--primary-color);
        }
        
        .issues-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 1.5rem;
        }
        
        .issue-card {
            background: var(--light-bg);
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            border: 1px solid var(--border-color);
            transition: transform 0.3s;
        }
        
        .issue-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary-color);
        }
        
        .issue-icon {
            font-size: clamp(1.8rem, 4vw, 2.2rem);
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        
        .issue-card h3 {
            font-family: "carilliantine", serif;
            font-size: clamp(1.3rem, 3vw, 1.6rem);
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        
        .issue-card p {
            font-family: "futura-pt", sans-serif;
            color: var(--secondary-color);
            font-size: 0.95rem;
            line-height: 1.4;
        }
        
        /* Servicios - MENU HORIZONTAL */
        .services-menu {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }
        
        .service-menu-btn {
            background: transparent;
            color: var(--secondary-color);
            border: 1px solid var(--border-color);
            padding: 0.6rem 1rem;
            font-family: "new-astro", sans-serif;
            font-size: 0.8rem;
            cursor: pointer;
            border-radius: 15px;
            transition: all 0.3s;
            white-space: nowrap;
        }
        
        .service-menu-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .service-menu-btn.active {
            background: var(--border-color);
            border-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .services-category {
            display: none;
            animation: fadeIn 0.5s;
        }
        
        .services-category.active {
            display: block;
        }
        
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }
        
        .service-card {
            background: var(--light-bg);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
            position: relative;
        }
        
        .service-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-5px);
        }
        
        .service-card h3 {
            font-family: "carilliantine", serif;
            font-size: clamp(1.2rem, 2.5vw, 1.5rem);
            margin-bottom: 0.5rem;
            color: var(--primary-color);
        }
        
        .service-price {
            font-family: "new-astro", sans-serif;
            font-size: clamp(1.1rem, 2.5vw, 1.3rem);
            color: #f8e9f0;
            margin-bottom: 0.5rem;
        }
        
        .service-price-usd {
            font-family: "futura-pt", sans-serif;
            font-size: 0.8rem;
            color: var(--secondary-color);
            margin-bottom: 1rem;
        }
        
        .service-description {
            font-family: "futura-pt", sans-serif;
            color: var(--secondary-color);
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .service-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--primary-color);
            color: var(--dark-bg);
            padding: 0.3rem 0.7rem;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        /* Botones de agregar/quitar servicio */
        .service-actions {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .quantity-controls {
            display: none;
            align-items: center;
            gap: 0.5rem;
        }
        
        .quantity-controls.active {
            display: flex;
        }
        
        .quantity-btn {
            background: var(--primary-color);
            color: var(--dark-bg);
            border: none;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .quantity-btn:hover {
            background: var(--secondary-color);
            transform: scale(1.1);
        }
        
        .quantity-display {
            min-width: 30px;
            text-align: center;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .add-to-cart-btn {
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-family: "new-astro", sans-serif;
            font-size: 0.8rem;
            transition: all 0.3s;
        }
        
        .add-to-cart-btn:hover {
            background: var(--primary-color);
            color: var(--dark-bg);
        }
        
        /* Indicador de cantidad en servicios */
        .service-quantity-indicator {
            position: absolute;
            top: -8px;
            right: -8px;
            background: #ff6b6b;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: bold;
            border: 2px solid var(--dark-bg);
        }
        
        /* Secci√≥n de promociones */
        .promotions-section {
            background: linear-gradient(135deg, rgba(255, 142, 199, 0.1), rgba(232, 185, 208, 0.05));
            padding: 2rem;
            border-radius: 15px;
            border: 1px solid var(--primary-color);
            margin-top: 2rem;
        }
        
        .promotion-card {
            background: rgba(45, 15, 31, 0.5);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
        }
        
        .promotion-card:hover {
            border-color: var(--primary-color);
        }
        
        .promotion-card h4 {
            font-family: "carilliantine", serif;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            font-size: 1.2rem;
        }
        
        .promotion-description {
            color: var(--secondary-color);
            font-size: 0.9rem;
            line-height: 1.4;
        }
        
        .promotion-badge {
            background: #ffd700;
            color: #2d0f1f;
            padding: 0.2rem 0.6rem;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 0.5rem;
        }
        
        .promotion-active {
            border-left: 4px solid #ffd700;
        }
        
        /* Bot√≥n especial para cumplea√±os */
        .birthday-promo-btn {
            background: linear-gradient(135deg, #ff8ec7, #ffd700);
            color: #2d0f1f;
            border: none;
            padding: 1rem 2rem;
            border-radius: 25px;
            font-family: "carilliantine", serif;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            margin: 1rem auto;
            display: block;
            text-align: center;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
        }
        
        .birthday-promo-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
        }
        
        .birthday-promo-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .birthday-promo-btn:disabled:hover {
            transform: none !important;
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5) !important;
        }
        
        /* Formulario de cita */
        .appointment-form {
            background: var(--light-bg);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            max-width: 800px;
            margin: 0 auto;
        }
        
        .location-note {
            background: rgba(255, 142, 199, 0.1);
            border: 1px solid var(--primary-color);
            border-radius: 5px;
            padding: 1rem;
            margin-bottom: 1.5rem;
            text-align: center;
            font-family: "new-astro", sans-serif;
            color: var(--primary-color);
            font-size: 0.9rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-family: "new-astro", sans-serif;
            color: var(--primary-color);
            font-size: 0.95rem;
        }
        
        .form-control {
            width: 100%;
            padding: 0.8rem;
            background: rgba(45, 15, 31, 0.5);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-family: "futura-pt", sans-serif;
            font-size: 0.95rem;
            color: #f8e9f0;
            transition: border-color 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        textarea.form-control {
            min-height: 100px;
            resize: vertical;
        }
        
        .radio-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .radio-option {
            display: flex;
            align-items: center;
        }
        
        .radio-option input {
            margin-right: 0.5rem;
            accent-color: var(--primary-color);
        }
        
        .radio-option label {
            margin-bottom: 0;
            font-family: "futura-pt", sans-serif;
            color: var(--secondary-color);
            font-size: 0.9rem;
        }
        
        /* Secci√≥n de servicios seleccionados */
        .selected-services {
            background: rgba(255, 142, 199, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .selected-services h3 {
            color: var(--primary-color);
            font-family: "carilliantine", serif;
            margin-bottom: 1rem;
            text-align: center;
        }
        
        .selected-service-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.8rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .selected-service-item:last-child {
            border-bottom: none;
        }
        
        .service-item-info {
            flex: 1;
        }
        
        .service-item-name {
            font-weight: bold;
            color: var(--primary-color);
            font-family: "carilliantine", serif;
        }
        
        .service-item-price {
            color: var(--secondary-color);
            font-size: 0.9rem;
        }
        
        .service-item-price-usd {
            color: var(--secondary-color);
            font-size: 0.8rem;
            opacity: 0.8;
        }
        
        .service-item-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .remove-service-btn {
            background: transparent;
            color: #ff6b6b;
            border: 1px solid #ff6b6b;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }
        
        .remove-service-btn:hover {
            background: #ff6b6b;
            color: white;
        }
        
        .empty-cart {
            text-align: center;
            color: var(--secondary-color);
            padding: 2rem;
            font-style: italic;
        }
        
        .cart-total {
            text-align: right;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border-color);
            font-family: "carilliantine", serif;
            font-size: 1.2rem;
            color: var(--primary-color);
        }
        
        .cart-total-usd {
            text-align: right;
            margin-top: 0.5rem;
            font-family: "futura-pt", sans-serif;
            font-size: 1rem;
            color: var(--secondary-color);
        }
        
        /* NUEVOS ESTILOS PARA MOSTRAR DESCUENTOS */
        .discounts-section {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid #ffd700;
            border-radius: 10px;
            padding: 1.5rem;
            margin-top: 1rem;
            display: none;
        }
        
        .discounts-section.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        .discount-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
        }
        
        .discount-item:last-child {
            border-bottom: none;
        }
        
        .discount-description {
            color: #ffd700;
            font-family: "new-astro", sans-serif;
            font-size: 0.9rem;
        }
        
        .discount-amount {
            color: #ffd700;
            font-weight: bold;
            font-family: "carilliantine", serif;
        }
        
        .final-total {
            text-align: right;
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 2px solid #ffd700;
            font-family: "carilliantine", serif;
            font-size: 1.3rem;
            color: #ffd700;
        }
        
        .final-total-usd {
            text-align: right;
            margin-top: 0.5rem;
            font-family: "futura-pt", sans-serif;
            font-size: 1.1rem;
            color: #ffd700;
        }
        
        .discounts-title {
            color: #ffd700;
            font-family: "carilliantine", serif;
            margin-bottom: 1rem;
            text-align: center;
            font-size: 1.2rem;
        }
        
        /* Secci√≥n de domicilio */
        .domicilio-section {
            display: none;
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: rgba(255, 142, 199, 0.05);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        
        .domicilio-section.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        .warning-note {
            background: rgba(255, 215, 0, 0.1);
            border: 1px solid #ffd700;
            border-radius: 5px;
            padding: 1rem;
            margin-bottom: 1rem;
            font-family: "new-astro", sans-serif;
            color: #ffd700;
            font-size: 0.9rem;
        }
        
        /* Estilos para el mapa */
        #map {
            height: 300px;
            width: 100%;
            border-radius: 8px;
            border: 2px solid var(--primary-color);
            background: #1a0f1f;
        }
        
        .leaflet-container {
            background: #1a0f1f;
            font-family: "futura-pt", sans-serif;
        }
        
        .map-overlay {
            position: absolute;
            top: 10px;
            left: 10px;
            background: rgba(255, 142, 199, 0.9);
            padding: 8px 12px;
            border-radius: 15px;
            color: #2d0f1f;
            font-size: 0.75rem;
            z-index: 1000;
            font-weight: bold;
            border: 2px solid #ff8ec7;
        }
        
        .map-container {
            margin-top: 1rem;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            position: relative;
        }
        
        /* Estilo personalizado para el marcador */
        .custom-marker {
            background: #ff8ec7;
            border: 3px solid #2d0f1f;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            box-shadow: 0 0 10px rgba(255, 142, 199, 0.8);
        }
        
        .location-info {
            background: linear-gradient(135deg, rgba(255, 142, 199, 0.1), rgba(232, 185, 208, 0.1));
            border: 1px solid var(--primary-color);
            border-radius: 10px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .manual-address-section {
            margin-top: 1rem;
            padding: 1.5rem;
            background: rgba(255, 142, 199, 0.05);
            border-radius: 10px;
            border: 1px solid var(--border-color);
        }
        
        /* Secci√≥n de cumplea√±os */
        .birthday-section {
            display: none;
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: rgba(255, 215, 0, 0.1);
            border-radius: 8px;
            border: 1px solid #ffd700;
        }
        
        .birthday-section.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        .birthday-warning {
            background: rgba(255, 107, 107, 0.1);
            border: 1px solid #ff6b6b;
            border-radius: 5px;
            padding: 1rem;
            margin-top: 1rem;
            font-family: "new-astro", sans-serif;
            color: #ff6b6b;
            font-size: 0.9rem;
        }
        
        /* Mensajes de confirmaci√≥n */
        .confirmation-messages {
            margin-top: 1.5rem;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 1rem;
            color: var(--primary-color);
            font-family: "new-astro", sans-serif;
        }
        
        .success-message {
            display: none;
            background: rgba(0, 255, 0, 0.1);
            border: 1px solid #00ff00;
            border-radius: 5px;
            padding: 1rem;
            text-align: center;
            font-family: "new-astro", sans-serif;
            color: #00ff00;
        }
        
        .error-message {
            display: none;
            background: rgba(255, 0, 0, 0.1);
            border: 1px solid #ff0000;
            border-radius: 5px;
            padding: 1rem;
            text-align: center;
            font-family: "new-astro", sans-serif;
            color: #ff0000;
        }
        
        /* Secci√≥n de comentarios */
        .comments-section {
            margin-top: 3rem;
            padding: 2rem 0;
            background: var(--light-bg);
            border-radius: 15px;
            border: 1px solid var(--border-color);
        }

        .comment-form {
            background: rgba(255, 142, 199, 0.05);
            padding: 2rem;
            border-radius: 10px;
            margin-bottom: 2rem;
            border: 1px solid var(--border-color);
        }

        .comment-form h3 {
            color: var(--primary-color);
            font-family: "carilliantine", serif;
            margin-bottom: 1.5rem;
            text-align: center;
            font-size: 1.8rem;
        }

        .form-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .form-row .form-group {
            flex: 1;
            margin-bottom: 0;
        }

        .comments-list {
            display: grid;
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .comment-card {
            background: rgba(45, 15, 31, 0.5);
            padding: 1.5rem;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
        }

        .comment-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .comment-header > div:first-child {
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .comment-author {
            font-weight: bold;
            color: var(--primary-color);
            font-family: "carilliantine", serif;
        }

        .comment-date {
            color: var(--secondary-color);
            font-size: 0.8rem;
        }

        .comment-text {
            color: var(--secondary-color);
            line-height: 1.5;
        }

        .anonymous-badge {
            background: var(--primary-color);
            color: var(--dark-bg);
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-size: 0.7rem;
            margin-left: 0.5rem;
        }

        .empty-comments {
            text-align: center;
            color: var(--secondary-color);
            padding: 2rem;
            font-style: italic;
        }

        .loading-comments {
            text-align: center;
            color: var(--secondary-color);
            padding: 2rem;
            font-style: italic;
        }
        
        /* Footer */
        footer {
            background: var(--medium-bg);
            padding: 2rem 0 1rem;
            margin-top: 3rem;
            border-top: 1px solid var(--border-color);
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .footer-section h3 {
            margin-bottom: 1rem;
            font-family: "carilliantine", serif;
            color: var(--primary-color);
            font-size: clamp(1.1rem, 2.5vw, 1.3rem);
        }
        
        .footer-section p {
            margin-bottom: 0.7rem;
            font-family: "futura-pt", sans-serif;
            color: var(--secondary-color);
            font-size: 0.9rem;
        }
        
        .social-link {
            color: var(--primary-color);
            text-decoration: underline;
            transition: all 0.3s;
        }
        
        .social-link:hover {
            color: var(--secondary-color);
        }
        
        .footer-bottom {
            text-align: center;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(90, 42, 63, 0.5);
            font-family: "new-astro", sans-serif;
            color: var(--secondary-color);
            font-size: 0.85rem;
        }

        /* Estilos para ubicaciones */
        .location-badge {
            background: var(--primary-color);
            color: var(--dark-bg);
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            font-size: 0.7rem;
            margin-left: 0.5rem;
            font-family: "new-astro", sans-serif;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            header {
                padding: 0.8rem 0;
            }
            
            .tabs {
                gap: 3px;
            }
            
            .tab-button {
                padding: 0.4rem 0.6rem;
                font-size: 0.8rem;
                border-radius: 15px;
            }
            
            .hero {
                padding: 2rem 0;
            }
            
            .appointment-form {
                padding: 1.2rem;
            }
            
            #map {
                height: 250px;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .services-menu {
                flex-direction: column;
                align-items: center;
            }
            
            .service-menu-btn {
                width: 100%;
                max-width: 250px;
            }
            
            .selected-service-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .service-item-actions {
                align-self: flex-end;
            }

            .comment-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
        
        @media (max-width: 480px) {
            .header-content {
                padding: 0 10px;
            }
            
            .tab-button {
                font-size: 0.75rem;
                padding: 0.35rem 0.5rem;
            }
            
            .hero {
                padding: 1.5rem 0;
            }
            
            .tab-content {
                padding: 1.5rem 0;
            }
            
            .about-card, .issue-card, .service-card {
                padding: 1.2rem;
            }
            
            .footer-content {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
            
            #map {
                height: 200px;
            }
            
            .manual-address-section, .comment-form {
                padding: 1rem;
            }
            
            .service-actions {
                flex-direction: column;
                gap: 0.8rem;
            }
        }
        
        @media (max-width: 360px) {
            .tab-button {
                font-size: 0.7rem;
                padding: 0.3rem 0.4rem;
            }
            
            .logo {
                font-size: 1.6rem;
            }
            
            .tagline {
                font-size: 0.8rem;
            }
            
            #map {
                height: 180px;
            }
        }
    </style>
</head>
<body>
    <!-- Header y Navegaci√≥n -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">Afrody.ta Tarot</div>
                <div class="tagline">Una lectura precisa, √≠ntima y guiada por conocimiento</div>
                <ul class="tabs">
                    <li class="tab">
                        <button class="tab-button active" data-tab="inicio">Inicio</button>
                    </li>
                    <li class="tab">
                        <button class="tab-button" data-tab="problemas">Problemas</button>
                    </li>
                    <li class="tab">
                        <button class="tab-button" data-tab="servicios">Servicios</button>
                    </li>
                    <li class="tab">
                        <button class="tab-button" data-tab="cita">Agendar</button>
                    </li>
                    <li class="tab">
                        <button class="tab-button" data-tab="comentarios">Comentarios</button>
                    </li>
                </ul>
            </div>
        </div>
    </header>

    <!-- Contenido de las pesta√±as -->
    <main class="container">
        <!-- Pesta√±a Inicio -->
        <section id="inicio" class="tab-content active">
            <div class="hero">
                <div class="hero-content">
                    <h1>Del callej√≥n sin salida al camino claro</h1>
                    <p>Una lectura precisa, √≠ntima y guiada por conocimiento para quienes buscan respuestas aut√©nticas y direcci√≥n en los momentos importantes.</p>
                    
                    <div class="cta-section">
                        <p>¬øQu√© te depara el futuro cercano? ¬øQu√© pistas te dan las estrellas? ¬°Desc√∫brelo ahora mismo!</p>
                        <button class="btn" data-tab="cita">Recibir Lectura</button>
                    </div>
                </div>
            </div>
            
            <!-- Secci√≥n El Tarot en Inicio -->
            <h2 class="section-title">EL TAROT</h2>
            <p class="section-subtitle">Una herramienta de interpretaci√≥n simb√≥lica para ofrecer perspectiva, reflexi√≥n y gu√≠a</p>
            
            <div class="about-content">
                <div class="about-card">
                    <h3>¬øQu√© es el Tarot?</h3>
                    <p>El tarot es una herramienta de interpretaci√≥n simb√≥lica que utiliza una baraja estructurada para ofrecer perspectiva, reflexi√≥n y gu√≠a sobre distintos aspectos de la vida. A trav√©s de sus im√°genes, arquetipos y significados, el tarot permite analizar situaciones presentes, comprender procesos personales y explorar posibles caminos o decisiones.</p>
                    <p>No predice el futuro de manera absoluta; m√°s bien, funciona como un recurso de autoconocimiento, donde cada carta act√∫a como un espejo que refleja emociones, patrones, oportunidades y desaf√≠os. La lectura se basa en la conexi√≥n entre las cartas, la intuici√≥n y el contexto de la persona que consulta.</p>
                    <p>En esencia, el tarot es un espacio de di√°logo y comprensi√≥n, una herramienta que ayuda a ver lo que quiz√° no es tan evidente y a conectar con la propia intuici√≥n de una forma m√°s profunda y organizada.</p>
                </div>
                <div class="about-card">
                    <h3>Beneficios del Tarot</h3>
                    <ul class="readings-list">
                        <li><strong>Claridad en situaciones confusas:</strong> El tarot ayuda a entender mejor lo que est√° ocurriendo a nivel personal, emocional o externo, ofreciendo una visi√≥n m√°s ordenada y objetiva.</li>
                        <li><strong>Apoyo en la toma de decisiones:</strong> Permite analizar opciones, posibles consecuencias y caminos alternativos, ayudando a elegir con mayor seguridad y conciencia.</li>
                        <li><strong>Autoconocimiento y reflexi√≥n personal:</strong> Las cartas funcionan como un espejo que muestra patrones, emociones ocultas, fortalezas y √°reas que necesitan atenci√≥n.</li>
                        <li><strong>Comprensi√≥n de procesos emocionales:</strong> Ayuda a identificar bloqueos, miedos, expectativas y deseos profundos, facilitando la gesti√≥n emocional.</li>
                        <li><strong>Perspective externa y nueva visi√≥n:</strong> Una lectura brinda un punto de vista distinto al habitual, lo que puede abrir oportunidades de cambio o nuevas formas de entender una situaci√≥n.</li>
                        <li><strong>Identificaci√≥n de oportunidades y desaf√≠os:</strong> El tarot muestra elementos que quiz√° no son evidentes a simple vista, ayudando a anticipar o preparar mejor decisiones importantes.</li>
                        <li><strong>Acompa√±amiento en momentos importantes:</strong> Sirve como una herramienta de apoyo cuando la persona pasa por cambios, incertidumbre o periodos de crecimiento.</li>
                        <li><strong>Conexi√≥n con la intuici√≥n:</strong> Promueve una sensaci√≥n de claridad interna, ayudando a escuchar mejor la propia voz interior y confiar m√°s en ella.</li>
                        <li><strong>Organizaci√≥n mental y emocional:</strong> Al ver representado un problema o proceso en las cartas, es m√°s f√°cil comprenderlo, procesarlo y encontrar soluciones.</li>
                        <li><strong>Bienestar y calma:</strong> Una lectura bien realizada puede generar alivio, tranquilidad y una mejor comprensi√≥n de lo que se est√° viviendo.</li>
                    </ul>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 2rem; font-family: 'new-astro', sans-serif; color: var(--secondary-color);">
                <p>11:11 &nbsp; | &nbsp; @Afrody.ta_tt</p>
            </div>
        </section>

        <!-- Pesta√±a Problemas -->
        <section id="problemas" class="tab-content">
            <h2 class="section-title">¬øQU√â PROBLEMAS ABORDAMOS?</h2>
            <p class="section-subtitle">Nuestras lecturas te ayudan a encontrar claridad en las √°reas m√°s importantes de tu vida</p>
            
            <div class="issues-grid">
                <div class="issue-card">
                    <div class="issue-icon">üîÆ</div>
                    <h3>Futuro</h3>
                    <p>¬øQu√© eventos importantes te esperan en el futuro cercano?</p>
                </div>
                <div class="issue-card">
                    <div class="issue-icon">üíñ</div>
                    <h3>Amor</h3>
                    <p>¬øEst√°n destinados a estar juntos? ¬øC√≥mo recuperar o atraer el amor?</p>
                </div>
                <div class="issue-card">
                    <div class="issue-icon">üí∞</div>
                    <h3>Finanzas</h3>
                    <p>¬øVale la pena cambiar de trabajo? ¬øD√≥nde buscar oportunidades financieras?</p>
                </div>
                <div class="issue-card">
                    <div class="issue-icon">üìú</div>
                    <h3>Pasado</h3>
                    <p>¬øQu√© lecciones son importantes que aprendas?</p>
                </div>
            </div>
        </section>

        <!-- Pesta√±a Servicios -->
        <section id="servicios" class="tab-content">
            <h2 class="section-title">NUESTROS SERVICIOS</h2>
            <p class="section-subtitle">Selecciona la categor√≠a de lectura que necesitas</p>
            
            <div class="services-menu">
                <button class="service-menu-btn active" data-category="basicas">B√ÅSICAS</button>
                <button class="service-menu-btn" data-category="especiales">ESPECIALES</button>
                <button class="service-menu-btn" data-category="promociones">PROMOCIONES</button>
            </div>
            
            <!-- Lecturas B√°sicas -->
            <div class="services-category active" id="basicas">
                <div class="services-grid">
                    <!-- Los servicios b√°sicos se generar√°n din√°micamente -->
                </div>
            </div>
            
            <!-- Lecturas Especiales -->
            <div class="services-category" id="especiales">
                <div class="services-grid">
                    <!-- Los servicios especiales se generar√°n din√°micamente -->
                </div>
            </div>
            
            <!-- Promociones -->
            <div class="services-category" id="promociones">
                <div class="promotions-section">
                    <h3 class="section-title">üéÅ PROMOCIONES Y DESCUENTOS</h3>
                    
                    <!-- Bot√≥n especial para cumplea√±os -->
                    <button class="birthday-promo-btn" id="birthdayPromoBtn">
                        üéÇ ¬°ES MI CUMPLEA√ëOS! - LECTURA GRATIS
                    </button>
                    
                    <div class="promotion-card promotion-active" id="promo3x2">
                        <h4>3x2 <span class="promotion-badge">ACTIVA</span></h4>
                        <div class="promotion-description">
                            Pide 3 lecturas arriba de $250 MXN y ll√©vate una lectura gratis (valor m√°ximo $180 MXN). 
                            <strong>Promoci√≥n permanente.</strong>
                        </div>
                    </div>
                    
                    <div class="promotion-card promotion-active">
                        <h4>Lectura Gratis <span class="promotion-badge">ACTIVA</span></h4>
                        <div class="promotion-description">
                            En compras superiores a $500 MXN, recibe una lectura adicional gratis.
                            <strong>Promoci√≥n permanente.</strong>
                        </div>
                    </div>
                    
                    <div class="promotion-card" id="promoCartaAnio">
                        <h4>Carta del A√±o <span class="promotion-badge" id="badgeCartaAnio">TEMPORADA</span></h4>
                        <div class="promotion-description">
                            Al comprar una Lectura del A√±o, recibe gratis tu Carta Arcano del A√±o.
                            <strong id="textCartaAnio">V√°lido del 28 de Diciembre al 4 de Enero.</strong>
                        </div>
                    </div>
                    
                    <div class="promotion-card promotion-active" id="promoCumpleanos">
                        <h4>¬°Feliz Cumplea√±os! <span class="promotion-badge" id="badgeCumpleanos">ESPECIAL</span></h4>
                        <div class="promotion-description">
                            Lectura de cumplea√±os gratis (v√°lida 3 d√≠as antes y despu√©s de tu cumplea√±os).
                            <strong id="textCumpleanos">Solo una vez al a√±o por persona. Se solicitar√° identificaci√≥n oficial.</strong>
                        </div>
                    </div>
                    
                    <div class="promotion-card promotion-active">
                        <h4>Sesi√≥n N√∫mero 6 <span class="promotion-badge">ACTIVA</span></h4>
                        <div class="promotion-description">
                            En tu sexta sesi√≥n, recibe una lectura general gratis.
                            <strong>Para clientes frecuentes.</strong>
                        </div>
                    </div>
                    
                    <div class="promotion-card" id="promoBuenFin">
                        <h4>Buen Fin <span class="promotion-badge" id="badgeBuenFin">INACTIVA</span></h4>
                        <div class="promotion-description">
                            20% de descuento en todas las lecturas.
                            <strong id="textBuenFin">Pr√≥ximamente del 12 al 20 de noviembre.</strong>
                        </div>
                    </div>
                    
                    <div class="promotion-card" id="promoAnioNuevo">
                        <h4>A√±o Nuevo <span class="promotion-badge" id="badgeAnioNuevo">PR√ìXIMAMENTE</span></h4>
                        <div class="promotion-description">
                            10% de descuento en todas las lecturas.
                            <strong id="textAnioNuevo">Promoci√≥n de a√±o nuevo.</strong>
                        </div>
                    </div>
                    
                    <div class="promotion-card" id="promoMiCumple">
                        <h4>¬°ES MI CUMPLEA√ëOS! <span class="promotion-badge" id="badgeMiCumple">ESPECIAL</span></h4>
                        <div class="promotion-description">
                            5% de descuento en cualquier lectura el 13 de Octubre.
                            <strong>Celebrando mi cumplea√±os contigo.</strong>
                        </div>
                    </div>
                    
                    <div class="promotion-card promotion-active">
                        <h4>Te Recomend√© <span class="promotion-badge">ACTIVA</span></h4>
                        <div class="promotion-description">
                            Trae un nuevo cliente y recibe 15% de descuento en tu pr√≥xima compra (m√≠nimo $150 MXN).
                            <strong>Programa de referidos permanente.</strong>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 2rem;">
                <button class="btn" data-tab="cita" style="font-size: 1.1rem; padding: 1rem 2rem;">
                    üí´ Ver Servicios Seleccionados
                </button>
            </div>
        </section>

        <!-- Pesta√±a Agendar Cita -->
        <section id="cita" class="tab-content">
            <h2 class="section-title">AGENDA TU CITA</h2>
            <p class="section-subtitle">Completa el formulario y nos pondremos en contacto contigo para confirmar tu sesi√≥n</p>
            
            <div class="appointment-form">
                <!-- Secci√≥n de servicios seleccionados -->
                <div class="selected-services" id="selectedServices">
                    <h3>üõí Servicios Seleccionados</h3>
                    <div class="empty-cart" id="emptyCart">
                        No hay servicios seleccionados. Agrega servicios desde la pesta√±a "Servicios".
                    </div>
                    <div id="servicesList"></div>
                    
                    <!-- Secci√≥n para descuentos -->
                    <div class="discounts-section" id="discountsSection">
                        <div class="discounts-title">üéâ Descuentos Aplicados</div>
                        <div id="discountsList"></div>
                        <div class="final-total">
                            Total Final: $<span id="finalTotalAmount">0</span> MXN
                        </div>
                        <div class="final-total-usd" id="finalTotalUSD">
                            Total Final: $<span id="finalTotalAmountUSD">0</span> USD
                        </div>
                    </div>
                    
                    <div class="cart-total" id="cartTotal" style="display: none;">
                        Subtotal: $<span id="totalAmount">0</span> MXN
                    </div>
                    <div class="cart-total-usd" id="cartTotalUSD" style="display: none;">
                        Subtotal: $<span id="totalAmountUSD">0</span> USD
                    </div>
                </div>
                
                <div class="location-note">
                    <strong>‚ú® Importante:</strong> Las consultas a domicilio solo est√°n disponibles en Ciudad Madero - Tampico, Tamaulipas. Servicio con costo adicional de $50 MXN.
                </div>
                
                <form id="appointmentForm">
                    <div class="form-group">
                        <label for="name">Nombre completo *</label>
                        <input type="text" id="name" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="phone">N√∫mero de celular *</label>
                        <input type="tel" id="phone" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="email">Correo electr√≥nico *</label>
                        <input type="email" id="email" class="form-control" required>
                    </div>
                    
                    <!-- Secci√≥n de cumplea√±os -->
                    <div class="birthday-section" id="birthdaySection">
                        <div class="warning-note">
                            <strong>üéÇ LECTURA DE CUMPLEA√ëOS GRATIS</strong><br>
                            V√°lida 3 d√≠as antes y despu√©s de tu cumplea√±os. Solo una vez al a√±o por persona.
                        </div>
                        
                        <div class="form-group">
                            <label for="birthday">Fecha de cumplea√±os *</label>
                            <input type="date" id="birthday" class="form-control">
                            <small style="color: var(--secondary-color);">Se solicitar√° identificaci√≥n oficial para validar</small>
                        </div>
                        
                        <div class="birthday-warning" id="birthdayWarning" style="display: none;">
                            ‚ö†Ô∏è Esta lectura solo est√° disponible 3 d√≠as antes o despu√©s de tu cumplea√±os. Por favor selecciona otra lectura o verifica tu fecha.
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>Tipo de consulta *</label>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="domicilio" name="consultationType" value="domicilio">
                                <label for="domicilio">A domicilio (+$50 MXN adicional)</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="online" name="consultationType" value="online" checked>
                                <label for="online">En l√≠nea (WhatsApp)</label>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Secci√≥n de domicilio -->
                    <div class="domicilio-section" id="domicilioSection">
                        <div class="warning-note">
                            <strong>üìç Zona de Servicio:</strong> Ciudad Madero y Tampico, Tamaulipas. Si tu ubicaci√≥n est√° fuera de estas zonas, selecciona "En l√≠nea".
                        </div>
                        
                        <!-- Mapa -->
                        <div class="form-group">
                            <label>Selecciona tu ubicaci√≥n en el mapa</label>
                            <div class="map-container">
                                <div class="map-overlay">
                                    üìç Haz clic en tu ubicaci√≥n
                                </div>
                                <div id="map"></div>
                            </div>
                            <small style="color: var(--secondary-color);">Haz clic en el mapa para marcar tu ubicaci√≥n exacta</small>
                        </div>
                        
                        <!-- Informaci√≥n de la ubicaci√≥n seleccionada -->
                        <div class="location-info" id="locationInfo" style="display: none;">
                            <p><strong>üéØ Ubicaci√≥n confirmada:</strong> <span id="selectedLocation"></span></p>
                            <p><strong>üìè Coordenadas:</strong> <span id="coordinates"></span></p>
                        </div>
                        
                        <!-- Direcci√≥n manual -->
                        <div class="manual-address-section">
                            <div class="form-group">
                                <label for="direccionCompleta">üè† Direcci√≥n completa *</label>
                                <textarea id="direccionCompleta" class="form-control" placeholder="Escribe tu direcci√≥n completa: calle, n√∫mero, colonia, entre calles, referencia..."></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label for="codigoPostal">üìÆ C√≥digo Postal *</label>
                                <input type="text" id="codigoPostal" class="form-control" placeholder="89400">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="comments">Comentarios adicionales</label>
                        <textarea id="comments" class="form-control" placeholder="Cu√©ntanos m√°s sobre tu situaci√≥n, preguntas espec√≠ficas o cualquier informaci√≥n que consideres relevante..."></textarea>
                    </div>
                    
                    <button type="submit" class="btn" style="width: 100%;" id="submitButton">Enviar solicitud de cita</button>
                    
                    <!-- Mensajes de confirmaci√≥n -->
                    <div class="confirmation-messages">
                        <div class="loading" id="loadingMessage">
                            Enviando tu solicitud...
                        </div>
                        
                        <div class="success-message" id="successMessage">
                            ¬°Gracias! Tu solicitud ha sido enviada correctamente. Nos pondremos en contacto contigo en un plazo de 24 horas.
                        </div>
                        
                        <div class="error-message" id="errorMessage">
                            Ha ocurrido un error al enviar tu solicitud. Por favor, intenta nuevamente o cont√°ctanos directamente.
                        </div>
                    </div>
                </form>
            </div>
        </section>

        <!-- Pesta√±a Comentarios -->
        <section id="comentarios" class="tab-content">
            <h2 class="section-title">COMENTARIOS Y TESTIMONIOS</h2>
            <p class="section-subtitle">Comparte tu experiencia o deja un mensaje an√≥nimo</p>
            
            <div class="comments-section">
                <div class="comment-form">
                    <h3>üí¨ Deja tu comentario</h3>
                    <form id="commentForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="commentName">Nombre *</label>
                                <input type="text" id="commentName" class="form-control" placeholder="Tu nombre" required>
                            </div>
                            <div class="form-group">
                                <label for="commentPhone">N√∫mero de tel√©fono *</label>
                                <input type="tel" id="commentPhone" class="form-control" placeholder="Tu n√∫mero de tel√©fono" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="commentText">Tu comentario *</label>
                            <textarea id="commentText" class="form-control" placeholder="Comparte tu experiencia, testimonio o cualquier mensaje que quieras dejar..." required rows="5"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <div class="radio-option">
                                <input type="checkbox" id="isAnonymous">
                                <label for="isAnonymous">Publicar como an√≥nimo (tu nombre y tel√©fono no se mostrar√°n)</label>
                            </div>
                        </div>
                        
                        <button type="submit" class="btn" style="width: 100%;" id="submitCommentBtn">Publicar comentario</button>
                    </form>
                </div>
                
                <div class="comments-list" id="commentsList">
                    <div class="loading-comments">
                        üì° Cargando comentarios...
                    </div>
                    <!-- Los comentarios se cargar√°n aqu√≠ din√°micamente -->
                </div>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Contacto</h3>
                    <p>Email: afrody.taa@outlook.com</p>
                    <p>Tel√©fono: +52 833 437 7000</p>
                    <p>Direcci√≥n: Ciudad Madero - Tampico, Tamaulipas, M√©xico</p>
                </div>
                <div class="footer-section">
                    <h3>Horarios de Atenci√≥n</h3>
                    <p>‚ú¶ Lunes a Viernes: 8:00 - 12:00 / 20:00 - 23:00</p>
                    <p>‚ú¶ S√°bados: 7:00 - 11:00</p>
                    <p>‚ú¶ Domingos: Cerrado</p>
                </div>
                <div class="footer-section">
                    <h3>S√≠guenos</h3>
                    <p>Instagram: <a href="https://www.instagram.com/afrody.ta_tt?igsh=MTk4bTJ0bmtvMnpvbA==" class="social-link" target="_blank">@Afrody.ta_tt</a></p>
                    <p>Canal WhatsApp: <a href="https://whatsapp.com/channel/0029VampIdu0bIdemvm4Jf25" class="social-link" target="_blank">Lectura de Cartas, Magia, Manifestaci√≥n y M√°s</a></p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 AFRODYTA DESING. Todos los derechos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <script>
        // =============================================
        // CONFIGURACI√ìN GOOGLE SHEETS - SOLUCI√ìN JSONP
        // =============================================
        const SHEET_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbz0FfyZyxVbg8kFmJbprhNwlTYDNFVHpSj8CMpWL0yVRQ2HvOui_h4QoIhIW0wOaz8/exec';

        // =============================================
        // TIPO DE CAMBIO MXN A USD
        // =============================================
        const EXCHANGE_RATE = 19; // 1 MXN = 19 USD

        // =============================================
        // FUNCIONES DE CONVERSI√ìN
        // =============================================
        function mxnToUsd(mxnAmount) {
            return (mxnAmount / EXCHANGE_RATE).toFixed(2);
        }

        function formatCurrencyMXN(amount) {
            return `$${amount} MXN`;
        }

        function formatCurrencyUSD(amount) {
            return `$${amount} USD`;
        }

        // =============================================
        // DATOS DE SERVICIOS
        // =============================================
        const servicesData = {
            basicas: [
                { id: 'general', name: 'Lectura General', price: 135, description: 'Una visi√≥n completa de tu situaci√≥n actual y energ√≠as que te rodean.' },
                { id: 'general_3p', name: 'General + 3 Preguntas', price: 180, description: 'Lectura general m√°s respuestas espec√≠ficas a 3 preguntas de tu inter√©s.' },
                { id: '1p', name: '1 Pregunta Espec√≠fica', price: 50, description: 'Respuesta clara y directa a una pregunta concreta que tengas.' },
                { id: '2p', name: '2 Preguntas', price: 65, description: 'Respuestas detalladas a dos preguntas importantes para ti.' },
                { id: '3p', name: '3 Preguntas', price: 90, description: 'An√°lisis completo de tres √°reas espec√≠ficas de tu inter√©s.' },
                { id: 'semanal', name: 'Lectura Semanal', price: 185, description: 'Pron√≥stico energ√©tico para los pr√≥ximos 7 d√≠as.' },
                { id: 'mes', name: 'Lectura del Mes', price: 230, description: 'Visi√≥n completa de las energ√≠as del mes entrante.' },
                { id: 'dia', name: 'Lectura del D√≠a', price: 120, description: 'Gu√≠a energ√©tica para tomar las mejores decisiones hoy.' },
                { id: 'anio', name: 'Lectura del A√±o', price: 450, description: 'Pron√≥stico anual completo con tendencias y oportunidades.' },
                { id: 'amorosa', name: 'Lectura General Amorosa', price: 150, description: 'Enfoque especial en relaciones sentimentales y conexiones.' }
            ],
            especiales: [
                { id: 'escudo', name: 'Escudo de Compras', price: 100, description: 'Protecci√≥n energ√©tica para tus compras e inversiones.' },
                { id: 'hora_espejo', name: 'Hora Espejo', price: 111, description: 'Interpretaci√≥n de mensajes divinos a trav√©s de horas espejo.' },
                { id: 'mercurio', name: 'Mercurio Retr√≥grado', price: 190, description: 'Gu√≠a para navegar per√≠odos de Mercurio retr√≥grado.' },
                { id: 'casi_algo', name: 'Casi Algo', price: 155, description: 'An√°lisis de situaciones de "casi relaciones" o conexiones ambiguas.' },
                { id: 'pareja', name: 'Lectura de Pareja', price: 250, description: 'An√°lisis completo de la din√°mica de pareja y compatibilidad.' },
                { id: 'crush', name: 'Crush', price: 270, description: 'Insight sobre esa persona especial y posibilidades de conexi√≥n.' },
                { id: 'ex', name: 'Ex', price: 290, description: 'An√°lisis de relaciones pasadas y cierres k√°rmicos.' },
                { id: 'esposos', name: '¬øC√≥mo seremos como Esposos?', price: 380, description: 'Visi√≥n del potencial de vida en pareja a largo plazo.' },
                { id: 'corazon', name: 'Lectura del Coraz√≥n', price: 200, description: 'An√°lisis profundo de tus emociones y bloqueos sentimentales.' },
                { id: 'amantes', name: 'Amantes', price: 300, description: 'Insight sobre relaciones pasionales y conexiones intensas.' },
                { id: 'compatibilidad', name: 'Compatibilidad', price: 222, description: 'An√°lisis detallado de compatibilidad energ√©tica y emocional.' },
                { id: 'que_siente', name: '¬øQu√© siente por m√≠?', price: 240, description: 'Descubre los sentimientos y pensamientos de esa persona especial.' },
                { id: 'hack_pareja', name: 'Hack Pareja', price: 280, description: 'Estrategias energ√©ticas para mejorar tu relaci√≥n de pareja.' },
                { id: 'tinder', name: 'Tinder', price: 400, description: 'Gu√≠a para citas en l√≠nea y conexiones digitales aut√©nticas.' },
                { id: 'cupido', name: 'Consejo de Cupido', price: 400, description: 'Orientaci√≥n divina para el amor y las relaciones.' },
                { id: 'sexo', name: 'Sexo', price: 269, description: 'An√°lisis de compatibilidad sexual y conexi√≥n √≠ntima.' },
                { id: 'lo_que_ve', name: 'Lo que ve y piensa de m√≠', price: 340, description: 'Insight sobre la percepci√≥n que otros tienen de ti.' },
                { id: 'evolucion', name: 'Evoluci√≥n en Pareja', price: 340, description: 'Proyecci√≥n del crecimiento y desarrollo de la relaci√≥n.' },
                { id: 'cumpleanos', name: 'Lectura de Cumplea√±os', price: 0, description: 'Lectura especial de cumplea√±os gratis (v√°lida 3 d√≠as antes/despu√©s)' }
            ]
        };

        // =============================================
        // SISTEMA DE COMENTARIOS MEJORADO CON JSONP
        // =============================================
        let comments = [];

        // Funci√≥n para cargar comentarios usando JSONP
        function loadComments() {
            const commentsList = document.getElementById('commentsList');
            commentsList.innerHTML = '<div class="loading-comments">üì° Cargando comentarios...</div>';
            
            // Cargar desde localStorage primero (instant√°neo)
            loadCommentsFromLocalStorage();
            
            // Intentar cargar desde Google Sheets usando JSONP
            loadCommentsFromGoogleSheetsJSONP();
        }

        // Funci√≥n para cargar comentarios usando JSONP - VERSI√ìN CORREGIDA
        function loadCommentsFromGoogleSheetsJSONP() {
            const callbackName = 'handleCommentsResponse_' + Date.now();
            window[callbackName] = function(data) {
                delete window[callbackName];
                if (script.parentNode) {
                    document.head.removeChild(script);
                }
                
                console.log('üîß Respuesta de carga:', data);
                
                if (data && data.success && data.comments) {
                    comments = data.comments;
                    displayComments();
                    localStorage.setItem('afrodyta_comments', JSON.stringify(comments));
                    console.log('‚úÖ Comentarios cargados desde Google Sheets:', data.comments.length, 'comentarios');
                } else if (data && data.error) {
                    console.log('‚ùå Error del servidor:', data.error);
                }
            };
            
            const script = document.createElement('script');
            const url = `${SHEET_SCRIPT_URL}?action=getComments&callback=${callbackName}&timestamp=${Date.now()}`;
            console.log('üåê Cargando desde:', url);
            script.src = url;
            
            script.onerror = function() {
                console.log('‚ùå Error cargando comentarios desde Google Sheets');
                delete window[callbackName];
                if (script.parentNode) {
                    document.head.removeChild(script);
                }
            };
            
            document.head.appendChild(script);
            
            // Timeout
            setTimeout(() => {
                if (script.parentNode) {
                    delete window[callbackName];
                    document.head.removeChild(script);
                    console.log('‚è∞ Timeout cargando comentarios');
                }
            }, 5000);
        }

        // Cargar comentarios desde localStorage
        function loadCommentsFromLocalStorage() {
            const localComments = JSON.parse(localStorage.getItem('afrodyta_comments')) || [];
            if (localComments.length > 0) {
                comments = localComments;
                displayComments();
            }
        }

        // Funci√≥n para guardar comentario usando JSONP - VERSI√ìN CORREGIDA
        function saveComment(comment) {
            return new Promise((resolve) => {
                // Primero guardar en localStorage
                const localSuccess = saveCommentToLocalStorage(comment);
                
                if (!localSuccess) {
                    resolve(false);
                    return;
                }
                
                // Intentar guardar en Google Sheets usando JSONP
                const callbackName = 'handleSaveCommentResponse_' + Date.now();
                window[callbackName] = function(data) {
                    delete window[callbackName];
                    if (script.parentNode) {
                        document.head.removeChild(script);
                    }
                    
                    console.log('üîß Respuesta de Google Sheets:', data);
                    
                    if (data && data.success) {
                        console.log('‚úÖ Comentario guardado en Google Sheets');
                        resolve(true);
                    } else {
                        console.log('üìù Comentario guardado en localStorage (fallback)');
                        resolve(true);
                    }
                };
                
                // Preparar URL para JSONP - FORMA CORRECTA
                const params = new URLSearchParams();
                params.append('action', 'addComment');
                params.append('author', comment.author);
                params.append('text', comment.text);
                params.append('phone', comment.phone);
                params.append('isAnonymous', comment.isAnonymous ? 'true' : 'false');
                params.append('location', comment.location);
                params.append('date', comment.date);
                params.append('timestamp', comment.timestamp);
                params.append('callback', callbackName);
                
                const script = document.createElement('script');
                const url = `${SHEET_SCRIPT_URL}?${params.toString()}`;
                console.log('üåê Enviando a:', url);
                script.src = url;
                
                script.onerror = function() {
                    console.log('‚ùå Error de carga del script JSONP');
                    delete window[callbackName];
                    if (script.parentNode) {
                        document.head.removeChild(script);
                    }
                    console.log('üìù Comentario guardado en localStorage (fallback JSONP)');
                    resolve(true);
                };
                
                document.head.appendChild(script);
                
                // Timeout m√°s corto
                setTimeout(() => {
                    if (script.parentNode) {
                        delete window[callbackName];
                        document.head.removeChild(script);
                        console.log('‚è∞ Comentario guardado en localStorage (timeout JSONP)');
                        resolve(true);
                    }
                }, 3000);
            });
        }

        // Guardar comentario en localStorage
        function saveCommentToLocalStorage(comment) {
            try {
                comments.unshift(comment);
                localStorage.setItem('afrodyta_comments', JSON.stringify(comments));
                displayComments();
                return true;
            } catch (error) {
                console.error('Error guardando en localStorage:', error);
                return false;
            }
        }

        // Funci√≥n para mostrar comentarios
        function displayComments() {
            const commentsList = document.getElementById('commentsList');
            
            if (comments.length === 0) {
                commentsList.innerHTML = '<div class="empty-comments">üåü S√© el primero en dejar un comentario</div>';
                return;
            }

            commentsList.innerHTML = comments.map(comment => `
                <div class="comment-card">
                    <div class="comment-header">
                        <div>
                            <span class="comment-author">${comment.author}</span>
                            ${comment.isAnonymous ? '<span class="anonymous-badge">An√≥nimo</span>' : ''}
                            ${comment.location && comment.location !== 'Ubicaci√≥n no disponible' ? 
                              `<span class="location-badge">üìç ${comment.location}</span>` : ''}
                        </div>
                        <div class="comment-date">${comment.date}</div>
                    </div>
                    <div class="comment-text">${comment.text}</div>
                </div>
            `).join('');
        }

        // =============================================
        // SISTEMA DE CONTROL DE LECTURA DE CUMPLEA√ëOS
        // =============================================
        
        // Verificar si ya se reclam√≥ la lectura de cumplea√±os
        function hasClaimedBirthdayReading() {
            const claimed = localStorage.getItem('afrodyta_birthday_claimed');
            if (!claimed) return false;
            
            const claimDate = new Date(claimed);
            const today = new Date();
            
            // Verificar si la reclamaci√≥n fue hace menos de 1 a√±o
            const oneYearAgo = new Date();
            oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);
            
            return claimDate > oneYearAgo;
        }

        // Marcar lectura de cumplea√±os como reclamada
        function markBirthdayAsClaimed() {
            localStorage.setItem('afrodyta_birthday_claimed', new Date().toISOString());
            updateBirthdayButtonState();
        }

        // Actualizar estado del bot√≥n de cumplea√±os
        function updateBirthdayButtonState() {
            const birthdayBtn = document.getElementById('birthdayPromoBtn');
            const hasClaimed = hasClaimedBirthdayReading();
            
            if (hasClaimed) {
                birthdayBtn.disabled = true;
                birthdayBtn.textContent = 'üéÇ YA RECLAMASTE TU LECTURA DE CUMPLEA√ëOS';
                birthdayBtn.title = 'Solo puedes reclamar una lectura de cumplea√±os por a√±o';
            } else {
                birthdayBtn.disabled = false;
                birthdayBtn.textContent = 'üéÇ ¬°ES MI CUMPLEA√ëOS! - LECTURA GRATIS';
                birthdayBtn.title = 'Haz clic para reclamar tu lectura de cumplea√±os gratis';
            }
        }

        // Verificar si ya hay una lectura de cumplea√±os en el carrito
        function hasBirthdayInCart() {
            return selectedServices.some(service => service.id === 'cumpleanos');
        }

        // Funci√≥n para obtener ubicaci√≥n
        function getLocation() {
            return new Promise((resolve) => {
                if (!navigator.geolocation) {
                    resolve('Ubicaci√≥n no disponible');
                    return;
                }

                const timeoutId = setTimeout(() => {
                    resolve('Ubicaci√≥n no disponible');
                }, 3000);

                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        clearTimeout(timeoutId);
                        try {
                            const { latitude, longitude } = position.coords;
                            const response = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${latitude}&longitude=${longitude}&localityLanguage=es`);
                            const data = await response.json();
                            resolve(`${data.city}, ${data.countryName}`);
                        } catch (error) {
                            resolve('Ubicaci√≥n no disponible');
                        }
                    },
                    (error) => {
                        clearTimeout(timeoutId);
                        resolve('Ubicaci√≥n no disponible');
                    },
                    { 
                        timeout: 3000,
                        enableHighAccuracy: false 
                    }
                );
            });
        }

        // =============================================
        // C√ìDIGO EXISTENTE DEL SISTEMA PRINCIPAL
        // =============================================
        
        // Carrito de servicios
        let selectedServices = JSON.parse(localStorage.getItem('afrodyta_cart')) || [];

        // Mapa
        let map;
        let marker;
        let selectedLocation = null;

        function initMap() {
            if (map) return;
            
            const madero = [22.2699999, -97.8363];
            
            map = L.map('map').setView(madero, 14);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: 'OpenStreetMap',
                maxZoom: 18
            }).addTo(map);
            
            const pinkIcon = L.divIcon({
                className: 'custom-marker',
                html: 'üìç',
                iconSize: [30, 30],
                iconAnchor: [15, 30]
            });
            
            marker = L.marker(madero, {
                draggable: true,
                icon: pinkIcon
            }).addTo(map);
            
            marker.bindPopup("<div style='text-align: center;'><strong>Tu ubicaci√≥n</strong><br>Arrastra el marcador</div>").openPopup();
            
            marker.on('dragend', function(event) {
                const marker = event.target;
                const position = marker.getLatLng();
                updateLocation(position);
            });
            
            map.on('click', function(event) {
                const position = event.latlng;
                marker.setLatLng(position);
                updateLocation(position);
            });
        }

        function updateLocation(position) {
            selectedLocation = {
                lat: position.lat,
                lng: position.lng
            };
            
            document.getElementById('selectedLocation').textContent = `Lat: ${position.lat.toFixed(6)}, Lng: ${position.lng.toFixed(6)}`;
            document.getElementById('coordinates').textContent = `${position.lat.toFixed(6)}, ${position.lng.toFixed(6)}`;
            document.getElementById('locationInfo').style.display = 'block';
        }

        // Sistema de carrito
        function addToCart(service) {
            // Verificar si es lectura de cumplea√±os y ya est√° reclamada
            if (service.id === 'cumpleanos') {
                if (hasClaimedBirthdayReading()) {
                    showNotification('‚ùå Ya reclamaste tu lectura de cumplea√±os este a√±o');
                    return;
                }
                
                if (hasBirthdayInCart()) {
                    showNotification('‚ö†Ô∏è Ya tienes una lectura de cumplea√±os en el carrito');
                    return;
                }
                
                // Marcar como reclamada
                markBirthdayAsClaimed();
            }
            
            const existingService = selectedServices.find(item => item.id === service.id);
            
            if (existingService) {
                existingService.quantity += 1;
            } else {
                selectedServices.push({
                    ...service,
                    quantity: 1
                });
            }
            
            saveCart();
            updateCartDisplay();
            updateServicesDisplay();
            
            showNotification(`‚úÖ ${service.name} agregado al carrito`);
        }

        function removeFromCart(serviceId) {
            const service = selectedServices.find(item => item.id === serviceId);
            
            // Si es lectura de cumplea√±os, permitir remover sin afectar el l√≠mite anual
            if (serviceId === 'cumpleanos') {
                // No removemos la marca de reclamaci√≥n para evitar abusos
                // El usuario podr√° agregarla nuevamente si la remueve
            }
            
            selectedServices = selectedServices.filter(item => item.id !== serviceId);
            saveCart();
            updateCartDisplay();
            updateServicesDisplay();
        }

        function updateQuantity(serviceId, change) {
            const service = selectedServices.find(item => item.id === serviceId);
            if (service) {
                // Para lectura de cumplea√±os, no permitir m√°s de 1
                if (service.id === 'cumpleanos' && service.quantity + change > 1) {
                    showNotification('‚ùå Solo puedes tener una lectura de cumplea√±os');
                    return;
                }
                
                service.quantity += change;
                if (service.quantity <= 0) {
                    removeFromCart(serviceId);
                } else {
                    saveCart();
                    updateCartDisplay();
                    updateServicesDisplay();
                }
            }
        }

        function saveCart() {
            localStorage.setItem('afrodyta_cart', JSON.stringify(selectedServices));
        }

        // FUNCI√ìN: Aplicar promociones y mostrar descuentos
        function applyPromotions(total) {
            let finalTotal = total;
            let discounts = [];
            
            // Promoci√≥n 3x2
            const expensiveServices = selectedServices
                .filter(service => service.price >= 250)
                .sort((a, b) => b.price - a.price);
            
            if (expensiveServices.length >= 3) {
                const freeService = expensiveServices[0];
                const discount = Math.min(freeService.price * freeService.quantity, 180);
                finalTotal -= discount;
                discounts.push({
                    description: `üéÅ Promoci√≥n 3x2: ${freeService.name} gratis`,
                    amount: discount
                });
            }
            
            // Promoci√≥n Lectura Gratis en compras > $500
            if (total > 500 && discounts.length === 0) {
                const freeReading = Math.min(180, total * 0.2);
                finalTotal -= freeReading;
                discounts.push({
                    description: 'üéÅ Lectura gratis en compras mayores a $500 MXN',
                    amount: freeReading
                });
            }
            
            // Mostrar descuentos en la interfaz
            displayDiscounts(discounts, finalTotal);
            
            return finalTotal;
        }

        // FUNCI√ìN: Mostrar descuentos aplicados
        function displayDiscounts(discounts, finalTotal) {
            const discountsSection = document.getElementById('discountsSection');
            const discountsList = document.getElementById('discountsList');
            const finalTotalAmount = document.getElementById('finalTotalAmount');
            const finalTotalAmountUSD = document.getElementById('finalTotalAmountUSD');
            
            if (discounts.length > 0) {
                discountsSection.classList.add('active');
                discountsList.innerHTML = discounts.map(discount => `
                    <div class="discount-item">
                        <span class="discount-description">${discount.description}</span>
                        <span class="discount-amount">-$${discount.amount} MXN</span>
                    </div>
                `).join('');
                finalTotalAmount.textContent = finalTotal;
                finalTotalAmountUSD.textContent = mxnToUsd(finalTotal);
            } else {
                discountsSection.classList.remove('active');
            }
        }

        // FUNCI√ìN: Actualizar carrito para incluir descuentos
        function updateCartDisplay() {
            const servicesList = document.getElementById('servicesList');
            const emptyCart = document.getElementById('emptyCart');
            const cartTotal = document.getElementById('cartTotal');
            const cartTotalUSD = document.getElementById('cartTotalUSD');
            const totalAmount = document.getElementById('totalAmount');
            const totalAmountUSD = document.getElementById('totalAmountUSD');
            
            if (selectedServices.length === 0) {
                emptyCart.style.display = 'block';
                servicesList.innerHTML = '';
                cartTotal.style.display = 'none';
                cartTotalUSD.style.display = 'none';
                document.getElementById('discountsSection').classList.remove('active');
                return;
            }
            
            emptyCart.style.display = 'none';
            
            let subtotal = 0;
            let hasBirthdayReading = false;
            
            servicesList.innerHTML = selectedServices.map(service => {
                const serviceTotal = service.price * service.quantity;
                subtotal += serviceTotal;
                
                if (service.id === 'cumpleanos') {
                    hasBirthdayReading = true;
                }
                
                return `
                    <div class="selected-service-item">
                        <div class="service-item-info">
                            <div class="service-item-name">${service.name}</div>
                            <div class="service-item-price">$${service.price} MXN x ${service.quantity} = $${serviceTotal} MXN</div>
                            ${service.price > 0 ? `<div class="service-item-price-usd">$${mxnToUsd(service.price)} USD x ${service.quantity} = $${mxnToUsd(serviceTotal)} USD</div>` : ''}
                        </div>
                        <div class="service-item-actions">
                            <div class="quantity-controls active">
                                <button class="quantity-btn" onclick="updateQuantity('${service.id}', -1)">-</button>
                                <span class="quantity-display">${service.quantity}</span>
                                <button class="quantity-btn" onclick="updateQuantity('${service.id}', 1)">+</button>
                            </div>
                            <button class="remove-service-btn" onclick="removeFromCart('${service.id}')">√ó</button>
                        </div>
                    </div>
                `;
            }).join('');
            
            totalAmount.textContent = subtotal;
            totalAmountUSD.textContent = mxnToUsd(subtotal);
            cartTotal.style.display = 'block';
            cartTotalUSD.style.display = 'block';
            
            // APLICAR PROMOCIONES
            const finalTotal = applyPromotions(subtotal);
            
            const birthdaySection = document.getElementById('birthdaySection');
            if (hasBirthdayReading) {
                birthdaySection.classList.add('active');
            } else {
                birthdaySection.classList.remove('active');
            }
        }

        function updateServicesDisplay() {
            for (const category in servicesData) {
                const container = document.querySelector(`#${category} .services-grid`);
                if (container) {
                    container.innerHTML = servicesData[category].map(service => {
                        const quantity = getServiceQuantity(service.id);
                        const hasQuantity = quantity > 0;
                        
                        // Para lectura de cumplea√±os, verificar si ya fue reclamada
                        const isBirthdayClaimed = service.id === 'cumpleanos' && hasClaimedBirthdayReading() && !hasQuantity;
                        
                        return `
                            <div class="service-card" style="position: relative;">
                                ${hasQuantity ? `<div class="service-quantity-indicator">${quantity}</div>` : ''}
                                <h3>${service.name}</h3>
                                <div class="service-price">${service.price === 0 ? 'GRATIS' : `$${service.price} MXN`}</div>
                                ${service.price > 0 ? `<div class="service-price-usd">$${mxnToUsd(service.price)} USD</div>` : ''}
                                <div class="service-description">
                                    ${service.description}
                                    ${isBirthdayClaimed ? '<br><small style="color: #ff6b6b;">‚ö†Ô∏è Ya reclamaste esta promoci√≥n este a√±o</small>' : ''}
                                </div>
                                <div class="service-actions">
                                    <div class="quantity-controls ${hasQuantity ? 'active' : ''}">
                                        <button class="quantity-btn" onclick="updateQuantity('${service.id}', -1)">-</button>
                                        <span class="quantity-display">${quantity}</span>
                                        <button class="quantity-btn" onclick="updateQuantity('${service.id}', 1)">+</button>
                                    </div>
                                    <button class="add-to-cart-btn" 
                                        onclick="addToCart(${JSON.stringify(service).replace(/"/g, '&quot;')})"
                                        ${isBirthdayClaimed ? 'disabled style="opacity: 0.5; cursor: not-allowed;"' : ''}>
                                        ${isBirthdayClaimed ? 'Ya Reclamado' : (hasQuantity ? 'Actualizar' : 'Agregar')}
                                    </button>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            }
        }

        function getServiceQuantity(serviceId) {
            const service = selectedServices.find(item => item.id === serviceId);
            return service ? service.quantity : 0;
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--primary-color);
                color: var(--dark-bg);
                padding: 1rem 1.5rem;
                border-radius: 10px;
                font-family: "new-astro", sans-serif;
                z-index: 10000;
                animation: slideIn 0.3s ease-out;
                box-shadow: 0 4px 15px rgba(255, 142, 199, 0.3);
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Validaci√≥n de cumplea√±os
        function isValidBirthdayForPromotion(birthday) {
            if (!birthday) return false;
            
            const today = new Date();
            const birthDate = new Date(birthday);
            
            const currentYear = today.getFullYear();
            birthDate.setFullYear(currentYear);
            
            const diffTime = Math.abs(today - birthDate);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
            
            return diffDays <= 3;
        }

        // Funcionalidad principal
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar estado del bot√≥n de cumplea√±os
            updateBirthdayButtonState();
            
            // Generar servicios
            updateServicesDisplay();
            
            // Cargar comentarios
            loadComments();
            
            // Actualizar carrito
            updateCartDisplay();
            
            // Sistema de pesta√±as
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');
            
            function switchTab(tabId) {
                tabButtons.forEach(button => button.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));
                
                document.querySelector(`.tab-button[data-tab="${tabId}"]`).classList.add('active');
                document.getElementById(tabId).classList.add('active');
                
                if (window.innerWidth <= 768) {
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
                
                // Inicializar mapa cuando la pesta√±a de cita est√© activa
                if (tabId === 'cita') {
                    setTimeout(() => {
                        if (!map) {
                            initMap();
                        } else {
                            map.invalidateSize();
                        }
                    }, 100);
                }
            }
            
            tabButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });

            // Sistema de men√∫ horizontal de servicios
            const serviceMenuBtns = document.querySelectorAll('.service-menu-btn');
            const serviceCategories = document.querySelectorAll('.services-category');
            
            serviceMenuBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const categoryId = this.getAttribute('data-category');
                    
                    serviceMenuBtns.forEach(b => b.classList.remove('active'));
                    serviceCategories.forEach(cat => cat.classList.remove('active'));
                    
                    this.classList.add('active');
                    document.getElementById(categoryId).classList.add('active');
                });
            });

            // Bot√≥n especial para cumplea√±os
            document.getElementById('birthdayPromoBtn').addEventListener('click', function() {
                if (this.disabled) {
                    showNotification('‚ùå Ya reclamaste tu lectura de cumplea√±os este a√±o');
                    return;
                }
                
                const birthdayService = {
                    id: 'cumpleanos',
                    name: 'Lectura de Cumplea√±os',
                    price: 0,
                    description: 'Lectura especial de cumplea√±os gratis (v√°lida 3 d√≠as antes/despu√©s)'
                };
                
                addToCart(birthdayService);
                switchTab('cita');
            });

            // Botones que redirigen a agendar cita
            document.querySelectorAll('.btn[data-tab="cita"]').forEach(element => {
                element.addEventListener('click', function() {
                    switchTab('cita');
                });
            });

            // Mostrar/ocultar secci√≥n de domicilio
            const domicilioRadio = document.getElementById('domicilio');
            const onlineRadio = document.getElementById('online');
            const domicilioSection = document.getElementById('domicilioSection');
            
            domicilioRadio.addEventListener('change', function() {
                if (this.checked) {
                    domicilioSection.classList.add('active');
                    setTimeout(() => {
                        if (!map) {
                            initMap();
                        } else {
                            map.invalidateSize();
                        }
                    }, 300);
                }
            });
            
            onlineRadio.addEventListener('change', function() {
                if (this.checked) {
                    domicilioSection.classList.remove('active');
                }
            });

            // Validaci√≥n de fecha de cumplea√±os
            const birthdayInput = document.getElementById('birthday');
            const birthdayWarning = document.getElementById('birthdayWarning');
            
            birthdayInput.addEventListener('change', function() {
                if (!isValidBirthdayForPromotion(this.value)) {
                    birthdayWarning.style.display = 'block';
                } else {
                    birthdayWarning.style.display = 'none';
                }
            });

            // =============================================
            // MANEJO DEL FORMULARIO DE COMENTARIOS
            // =============================================
            document.getElementById('commentForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                const name = document.getElementById('commentName').value.trim();
                const phone = document.getElementById('commentPhone').value.trim();
                const text = document.getElementById('commentText').value.trim();
                const isAnonymous = document.getElementById('isAnonymous').checked;
                
                if (!name || !phone || !text) {
                    alert('Por favor completa todos los campos obligatorios');
                    return;
                }

                // Validar tel√©fono
                const cleanPhone = phone.replace(/\D/g, '');
                if (cleanPhone.length !== 10) {
                    alert('Por favor ingresa un n√∫mero de tel√©fono v√°lido (10 d√≠gitos)');
                    return;
                }

                // Mostrar loading
                const submitBtn = document.getElementById('submitCommentBtn');
                const originalText = submitBtn.textContent;
                submitBtn.textContent = 'üåç Publicando...';
                submitBtn.disabled = true;

                try {
                    // Obtener ubicaci√≥n
                    const location = await getLocation();
                    
                    const firstName = isAnonymous ? 'An√≥nimo' : name.split(' ')[0];

                    const comment = {
                        author: firstName,
                        text: text,
                        phone: cleanPhone.substring(0, 3) + '*****' + cleanPhone.substring(8),
                        isAnonymous: isAnonymous,
                        location: location,
                        date: new Date().toLocaleDateString('es-MX', {
                            year: 'numeric',
                            month: 'long',
                            day: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        }),
                        timestamp: new Date().toISOString()
                    };

                    // Intentar guardar el comentario
                    const saved = await saveComment(comment);
                    
                    if (saved) {
                        this.reset();
                        document.getElementById('isAnonymous').checked = false;
                        showNotification('¬°Gracias por tu comentario! üåü');
                    } else {
                        showNotification('‚ùå Error al guardar comentario');
                    }
                    
                } catch (error) {
                    console.error('Error:', error);
                    showNotification('‚ùå Error al publicar comentario. Intenta nuevamente.');
                } finally {
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                }
            });

            // Manejo del formulario de citas
            document.getElementById('appointmentForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                console.log('Formulario enviado - Iniciando validaci√≥n...');
                
                // Validaci√≥n b√°sica
                if (selectedServices.length === 0) {
                    alert('Por favor agrega al menos un servicio antes de enviar la solicitud.');
                    return;
                }
                
                const name = document.getElementById('name').value.trim();
                const phone = document.getElementById('phone').value.trim();
                const email = document.getElementById('email').value.trim();
                const consultationType = document.querySelector('input[name="consultationType"]:checked');
                
                if (!name || !phone || !email) {
                    alert('Por favor completa todos los campos obligatorios.');
                    return;
                }
                
                if (!consultationType) {
                    alert('Por favor selecciona un tipo de consulta.');
                    return;
                }
                
                const consultationTypeValue = consultationType.value;
                const comments = document.getElementById('comments').value.trim();
                
                console.log('Tipo de consulta seleccionado:', consultationTypeValue);
                
                // Validar lectura de cumplea√±os
                const hasBirthdayReading = selectedServices.some(service => service.id === 'cumpleanos');
                if (hasBirthdayReading) {
                    const birthday = document.getElementById('birthday').value;
                    if (!isValidBirthdayForPromotion(birthday)) {
                        alert('La lectura de cumplea√±os solo est√° disponible 3 d√≠as antes o despu√©s de tu cumplea√±os. Por favor verifica tu fecha.');
                        return;
                    }
                }
                
                // Remover required de campos ocultos
                const direccionInput = document.getElementById('direccionCompleta');
                const codigoPostalInput = document.getElementById('codigoPostal');
                
                if (consultationTypeValue === 'online') {
                    // Para consultas en l√≠nea, remover required de campos de domicilio
                    direccionInput.removeAttribute('required');
                    codigoPostalInput.removeAttribute('required');
                } else {
                    // Para domicilio, agregar required
                    direccionInput.setAttribute('required', 'required');
                    codigoPostalInput.setAttribute('required', 'required');
                }
                
                // Preparar informaci√≥n del paquete
                let packageInfo = 'SERVICIOS SELECCIONADOS:\n';
                const subtotal = selectedServices.reduce((sum, service) => sum + (service.price * service.quantity), 0);
                const finalTotal = applyPromotions(subtotal);
                
                selectedServices.forEach(service => {
                    packageInfo += `‚Ä¢ ${service.name} x${service.quantity} - $${service.price * service.quantity} MXN\n`;
                });
                
                packageInfo += `\nSUBTOTAL: $${subtotal} MXN`;
                packageInfo += `\nSUBTOTAL: $${mxnToUsd(subtotal)} USD`;
                
                // Agregar informaci√≥n de descuentos
                const discountsSection = document.getElementById('discountsSection');
                if (discountsSection.classList.contains('active')) {
                    const discountItems = document.querySelectorAll('.discount-item');
                    discountItems.forEach(item => {
                        const desc = item.querySelector('.discount-description').textContent;
                        const amount = item.querySelector('.discount-amount').textContent;
                        packageInfo += `\n${desc}: ${amount}`;
                    });
                    packageInfo += `\nTOTAL FINAL: $${finalTotal} MXN`;
                    packageInfo += `\nTOTAL FINAL: $${mxnToUsd(finalTotal)} USD`;
                } else {
                    packageInfo += `\nTOTAL: $${finalTotal} MXN`;
                    packageInfo += `\nTOTAL: $${mxnToUsd(finalTotal)} USD`;
                }
                
                // Preparar informaci√≥n de ubicaci√≥n
                let direccion = 'Consulta en l√≠nea (WhatsApp)';
                let coordenadas = 'No aplica';
                let totalConDomicilio = finalTotal;
                
                if (consultationTypeValue === 'domicilio') {
                    const direccionValue = direccionInput.value.trim();
                    const codigoPostalValue = codigoPostalInput.value.trim();
                    
                    if (!direccionValue || !codigoPostalValue) {
                        alert('Para servicio a domicilio, por favor completa la direcci√≥n y c√≥digo postal.');
                        return;
                    }
                    
                    if (!selectedLocation) {
                        alert('Por favor selecciona una ubicaci√≥n en el mapa.');
                        return;
                    }
                    
                    direccion = `${direccionValue} | C.P. ${codigoPostalValue}`;
                    coordenadas = `${selectedLocation.lat.toFixed(6)}, ${selectedLocation.lng.toFixed(6)}`;
                    totalConDomicilio = finalTotal + 50;
                    
                    packageInfo += `\n\nüí´ SERVICIO A DOMICILIO: +$50 MXN`;
                    packageInfo += `\nTOTAL CON DOMICILIO: $${totalConDomicilio} MXN`;
                    packageInfo += `\nTOTAL CON DOMICILIO: $${mxnToUsd(totalConDomicilio)} USD`;
                }
                
                console.log('Preparando env√≠o de email...');
                
                // Mostrar loading
                document.getElementById('loadingMessage').style.display = 'block';
                document.getElementById('successMessage').style.display = 'none';
                document.getElementById('errorMessage').style.display = 'none';
                document.getElementById('submitButton').disabled = true;
                
                // Preparar par√°metros para EmailJS
                const templateParams = {
                    from_name: name,
                    from_phone: phone,
                    from_email: email,
                    package: packageInfo,
                    consultation_type: consultationTypeValue === 'domicilio' ? 'A domicilio (+$50 MXN adicional)' : 'En l√≠nea (WhatsApp)',
                    direccion: direccion,
                    coordenadas: coordenadas,
                    comments: comments || 'No proporcion√≥ comentarios adicionales',
                    date: new Date().toLocaleString('es-MX'),
                    total: consultationTypeValue === 'domicilio' ? totalConDomicilio : finalTotal,
                    total_usd: consultationTypeValue === 'domicilio' ? mxnToUsd(totalConDomicilio) : mxnToUsd(finalTotal)
                };
                
                console.log('Enviando correo con par√°metros:', templateParams);
                
                // Env√≠o del correo
                emailjs.send('service_z35hg3c', 'template_p8np16h', templateParams)
                    .then(function(response) {
                        console.log('SUCCESS!', response.status, response.text);
                        document.getElementById('loadingMessage').style.display = 'none';
                        document.getElementById('successMessage').style.display = 'block';
                        document.getElementById('submitButton').disabled = false;
                        
                        // Limpiar formulario despu√©s del √©xito
                        setTimeout(() => {
                            document.getElementById('appointmentForm').reset();
                            document.getElementById('successMessage').style.display = 'none';
                            document.getElementById('domicilioSection').classList.remove('active');
                            document.getElementById('birthdaySection').classList.remove('active');
                            document.getElementById('locationInfo').style.display = 'none';
                            selectedLocation = null;
                            
                            // Limpiar carrito
                            selectedServices = [];
                            saveCart();
                            updateCartDisplay();
                            updateServicesDisplay();
                            
                            console.log('Formulario limpiado exitosamente');
                        }, 5000);
                        
                    }, function(error) {
                        console.error('FAILED...', error);
                        document.getElementById('loadingMessage').style.display = 'none';
                        document.getElementById('errorMessage').style.display = 'block';
                        document.getElementById('submitButton').disabled = false;
                        
                        // Mostrar detalles del error
                        let errorDetails = 'Error desconocido';
                        if (error.text) {
                            errorDetails = error.text;
                        } else if (error.message) {
                            errorDetails = error.message;
                        }
                        console.error('Detalles del error:', errorDetails);
                    });
            });
        });

        // Estilos CSS para las notificaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            @keyframes slideOut {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
        `;
        document.head.appendChild(style);
    </script>
    
    <!-- EmailJS SDK -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script type="text/javascript">
        emailjs.init("D9IIhpZUFtIUOA0Rr");
    </script>
</body>
</html>
